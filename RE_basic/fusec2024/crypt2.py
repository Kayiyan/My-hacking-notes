# from sympy import symbols, Eq, solve

# # Các giá trị đã biết
# a = 393456223857499815661440893717237240259558532366307287354939441196311328949860421416124009442050320948087336435143720894089753027228194240947622428203376810145932210705733770034443667398090161183195152510628824806145343323163571130613629037517397113076778861973589406580949978852396850740937967511740793366718048124032828534650408728081568348328248119414349235373240606071821213323875846349460120944891074555047511689135169428789631873739254733345142491718992571738713056167486886120514825916775402671062923588643868842453016804611449814240016650065033987944589204140386114206477925791659758110022008860563780659396
# b = 11997006831727597838859364379547062689932572744654083166666125612150864313407998295085610421366633182857541448885000307627927684124124072436714719725683483054325256112952201064675498215555364445264410432688875142865327809337551169797877858548294909424784553164763477253336970584908792648056372024900456778666784310573833378011487122136965254930590589667169199039644211411717263218811900115539686093700331167756218836245807831177200156278406549658828318058079509048851064280486981767162435384614595648983175096386101363481286000348432698288589000697700575297289732367910581200141589916469083271346255824183497275727827
# c = 4894338948230470402928707660063586665636133877586628109286241259878275641109260494250817384130584823023329214861979751690561963081617330374455480937234003034778422057395258010775097230080392424358571869844921255624947595968885461336534123911023572529241708327941415913437014197548383286789776095955388635342283203973058210421769275756231192136995375798956898692310541958709215238144712661194018824033701744341479923354157538062092566495209486033904676472485258630642100327543009349262295112047920247519664433630167562500666323341592847174220829798027284008552903119224441839814665400078900184486541916998240568904705
# e = 65537

# # Biến p và q
# p, q = symbols('p q', integer=True)

# # Phương trình 1: a = (p - q)^2
# eq1 = Eq((p - q)**2, a)

# # Phương trình 2: 2b = -a + p**2 + (n/p)**2
# # Nhưng vì ta chưa có n, ta sẽ viết lại phương trình dưới dạng một phương trình duy nhất:
# eq2 = Eq(-a + p**2 + (b / p)**2, 2*b)

# # Giải phương trình
# solutions = solve((eq1, eq2), (p, q))

# # In kết quả
# for sol in solutions:
#     print(f"p = {sol[0]}")
#     print(f"q = {sol[1]}")

from Crypto.Util.number import long_to_bytes, inverse

# Các giá trị đã biết
p = 100061091073204407042373419423110161024500806639151784318343888121540822290159968991219618535454735441866530705394033259234803104733186630678226529250747023317740648210947323631298285719432523270895161774732188573317283401604164519420953069225838572651728030510780041704548725469998681841772045593502443375483
q = 119896822061940360749715038313638728396315739830424816299049920580631811834786510090338969591192193656726160703587106254660709424514906338391194699346098893673481500553336278247656630366523577659452296505059619635145108635945650048745018777443603842093287923389142137764047076410081148899374867168880940466569

# Tính giá trị n
n = p * q

# Tính giá trị phi(n)
phi_n = (p - 1) * (q - 1)

# Giá trị khóa công khai e
e = 65537

# Tính khóa riêng d
d = inverse(e, phi_n)

# Giá trị mã hóa c
c = 4894338948230470402928707660063586665636133877586628109286241259878275641109260494250817384130584823023329214861979751690561963081617330374455480937234003034778422057395258010775097230080392424358571869844921255624947595968885461336534123911023572529241708327941415913437014197548383286789776095955388635342283203973058210421769275756231192136995375798956898692310541958709215238144712661194018824033701744341479923354157538062092566495209486033904676472485258630642100327543009349262295112047920247519664433630167562500666323341592847174220829798027284008552903119224441839814665400078900184486541916998240568904705

# Giải mã giá trị m
m = pow(c, d, n)

# Chuyển đổi m về dạng bytes để lấy lại flag
flag = long_to_bytes(m)
print(flag)
